# originally taken from: https://github.com/qbit/dotfiles/blob/master/common/dot_ksh_completions
PKG_LIST=$(ls -1 /var/db/pkg)

function reload_completions {
  if [ -e ~/.ksh_completions ]; then
    . ~/.ksh_completions
    echo "ksh completions reloaded"
  fi
}

# for use with vmctl, the OpenBSD VMM daemon
# pgrep -q vmd
# if [ $? = 0 ]; then
#   set -A complete_vmctl -- console load reload start stop reset status send receive
#   set -A complete_vmctl_2 -- $(vmctl status | awk '!/NAME/{print $NF}')
# fi

# for https://www.passwordstore.org/
# if [ -d ~/.password-store ]; then
#   PASS_LIST=$(
#     cd ~/.password-store
#     find . -type f -name \*.gpg | sed 's/^\.\///' | sed 's/\.gpg$//g'
#   )
# 
#   set -A complete_pass -- $PASS_LIST -c generate edit insert git
#   set -A complete_pass_2 -- $PASS_LIST push
# 
#   set -A complete_gopass -- $PASS_LIST audit binary clone config copy create find fsck generate totp grep insert recipients sync version help
#   set -A complete_gopass_2 -- $PASS_LIST -c generate edit insert git
# fi

set -A complete_ssh -- $(awk '{split($1,a,","); print a[1]}' ~/.ssh/known_hosts)

set -A complete_rcctl_1 -- disable enable get ls order set
set -A complete_rcctl_2 -- $(ls /etc/rc.d)

set -A complete_signify_1 -- -C -G -S -V
set -A complete_signify_2 -- -q -p -x -c -m -t -z
set -A complete_signify_3 -- -p -x -c -m -t -z

# TODO can we ask git for tags/etc inside a repo with this?
set -A complete_git_1 -- pull push mpull mpush clone checkout status commit

set -A complete_ifconfig_1 -- $(ifconfig | grep ^[a-z] | cut -d: -f1)

set -A complete_mixerctl_1 -- $(mixerctl | cut -d= -f 1)

# set -A complete_lein_1 -- change check classpath clean compile deploy deps do help install jar javac new plugin pom release repl retest run search show-profiles test trampoline uberjar update-in upgrade vcs version with-profile
